> sudo -u postgres psql
psql (17.6 (Homebrew))
Type "help" for help.

postgres=# CREATE TABLE employees (
    emp_id SERIAL PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    department VARCHAR(50),
    email VARCHAR(100)
);
CREATE TABLE

postgres=# INSERT INTO employees (first_name, last_name, department, email) VALUES
('Alice', 'Johnson', 'IT', 'alice@alatoo.edu.kg'),
('Bob', 'Smith', 'Finance', 'bob@alatoo.edu.kg'),
('Carol', 'Brown', 'Sales', 'carol@alatoo.edu.kg');
INSERT 0 3

postgres=# COPY employees TO '/tmp/employees.csv' WITH CSV HEADER;
COPY 3

postgres=# \! head -n 5 /tmp/employees.csv
emp_id,first_name,last_name,department,email
1,Alice,Johnson,IT,alice@alatoo.edu.kg
2,Bob,Smith,Finance,bob@alatoo.edu.kg
3,Carol,Brown,Sales,carol@alatoo.edu.kg

postgres=# COPY employees TO '/tmp/employees.txt' WITH DELIMITER '|' NULL 'N/A' CSV HEADER;
COPY 3

postgres=# COPY (SELECT * FROM employees WHERE department = 'IT') TO '/tmp/it_employees.csv' WITH CSV HEADER;
COPY 1

postgres=# CREATE TABLE Airducts (
    Airduct_id SERIAL PRIMARY KEY,
    Airduct_name VARCHAR(100),
    price DECIMAL(10,2)
);
CREATE TABLE

postgres=# INSERT INTO Airducts (Airduct_name, price) VALUES
('Laptop', 1200.00),
('Mouse', 25.00),
('Keyboard', 70.00);
INSERT 0 3

postgres=# COPY Airducts TO '/tmp/Airducts.csv' WITH CSV HEADER;
COPY 3

postgres=# \! head -n 5 /tmp/Airducts.csv
Airduct_id,Airduct_name,price
1,Laptop,1200.00
2,Mouse,25.00
3,Keyboard,70.00

postgres=# CREATE TABLE customers (
    customer_id SERIAL PRIMARY KEY,
    customer_name VARCHAR(100),
    email VARCHAR(100)
);
CREATE TABLE

postgres=# INSERT INTO customers (customer_name, email) VALUES
('John Doe', 'john@example.com'),
('Jane Smith', 'jane@example.com');
INSERT 0 2

postgres=# COPY customers TO '/tmp/customers.csv' WITH CSV HEADER DELIMITER ';' QUOTE '"';
COPY 2

postgres=# CREATE TABLE orders (
    order_id SERIAL PRIMARY KEY,
    customer_id INT,
    order_date DATE DEFAULT CURRENT_DATE,
    total DECIMAL(10,2)
);
CREATE TABLE

postgres=# INSERT INTO orders (customer_id, total) VALUES
(1, 500.00),
(2, 700.00);
INSERT 0 2

postgres=# COPY orders TO '/tmp/orders.csv' WITH CSV HEADER FORCE_QUOTE (order_date);
COPY 2

postgres=# \! head -n 5 /tmp/orders.csv
order_id,customer_id,order_date,total
1,1,"2025-10-15",500.00
2,2,"2025-10-15",700.00

postgres=# COPY (SELECT * FROM Airducts WHERE price > 50) TO '/tmp/expensive_Airducts.csv' WITH CSV HEADER;
COPY 2

postgres=# \! head -n 5 /tmp/expensive_Airducts.csv
Airduct_id,Airduct_name,price
1,Laptop,1200.00
3,Keyboard,70.00

postgres=# \q 

> pg_dump -h localhost -U postgres -d postgres > /tmp/backup.sql
> pg_dump -h localhost -U postgres -d postgres -Fc > /tmp/backup.dump
> pg_dump -h localhost -U postgres -d postgres -t employees -t Airducts > /tmp/tables_backup.sql
> pg_dump -h localhost -U postgres -d postgres -Fc -v > /tmp/verbose_backup.dump
pg_dump: saving database definition
pg_dump: dumping contents of table "employees"
pg_dump: dumping contents of table "Airducts"
pg_dump: dump complete

> createdb restored_db
> pg_restore -h localhost -U postgres -d restored_db /tmp/backup.dump
> pg_restore -h localhost -U postgres -d postgres -j 4 /tmp/backup.dump

> echo "ğŸ”§ Schema and Data Backup Variants"
ğŸ”§ Schema and Data Backup Variants
> pg_dump -h localhost -U postgres -d postgres -s > /tmp/schema_only.sql
> pg_dump -h localhost -U postgres -d postgres -a > /tmp/data_only.sql
> pg_dumpall -h localhost -U postgres > /tmp/full_cluster_backup.sql

> pg_restore --list /tmp/backup.dump
;
; Archive created at 2025-10-15 18:40:33 +0600
;     dbname: postgres
;
; Archive list
;
TABLE employees
TABLE Airducts
;

> createdb test_restore
> pg_restore -d test_restore /tmp/backup.dump
